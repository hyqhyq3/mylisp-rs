# MyLisp - åŠŸèƒ½æ€»ç»“

MyLisp æ˜¯ä¸€ä¸ªç”¨ Rust å®ç°çš„ Lisp è§£é‡Šå™¨,å±•ç¤ºäº†å…ƒå¾ªç¯æ±‚å€¼å’Œç°ä»£è¯­è¨€ç‰¹æ€§çš„å®ç°ã€‚

## âœ… å·²å®ç°çš„æ ¸å¿ƒç‰¹æ€§

### 1. åŸºç¡€æ•°æ®ç±»å‹
- **æ•°å­—**: æµ®ç‚¹æ•°è¿ç®— (`+`, `-`, `*`, `/`, `mod`)
- **å­—ç¬¦ä¸²**: å­—ç¬¦ä¸²å­—é¢é‡å’Œæ“ä½œ
- **å¸ƒå°”å€¼**: `#t`, `#f`
- **ç¬¦å·**: å˜é‡å’Œå‡½æ•°å
- **åˆ—è¡¨**: S-expression åˆ—è¡¨ç»“æ„
- **Nil**: ç©ºå€¼

### 2. ç‰¹æ®Šå½¢å¼ (Special Forms)
- `define` - å®šä¹‰å˜é‡å’Œå‡½æ•°
- `set!` - ä¿®æ”¹å˜é‡å€¼
- `if` - æ¡ä»¶è¡¨è¾¾å¼
- `cond` - å¤šåˆ†æ”¯æ¡ä»¶(æ–°å¢)
- `begin` - é¡ºåºæ‰§è¡Œ(æ–°å¢)
- `lambda` / `fn` - åŒ¿åå‡½æ•°
- `let` - è¯æ³•ä½œç”¨åŸŸç»‘å®š
- `quote` - å¼•ç”¨(ä¸æ±‚å€¼)
- `eval` - åŠ¨æ€æ±‚å€¼
- `load` - åŠ è½½å¤–éƒ¨æ–‡ä»¶

### 3. é«˜é˜¶å‡½æ•° (æ–°å¢)
- `map` - æ˜ å°„å‡½æ•°åˆ°åˆ—è¡¨
- `filter` - è¿‡æ»¤åˆ—è¡¨å…ƒç´ 
- `fold` - åˆ—è¡¨æŠ˜å /å½’çº¦
- `length` - åˆ—è¡¨é•¿åº¦
- `reverse` - åè½¬åˆ—è¡¨
- `append` - è¿æ¥åˆ—è¡¨
- `cons` - æ„é€ åˆ—è¡¨
- `head`/`car` - å–é¦–å…ƒç´ 
- `tail`/`cdr` - å–å‰©ä½™å…ƒç´ 

### 4. è°“è¯å‡½æ•°
- `null?` - æ˜¯å¦ä¸ºç©º
- `symbol?` - æ˜¯å¦ä¸ºç¬¦å·
- `list?` - æ˜¯å¦ä¸ºåˆ—è¡¨
- `number?` - æ˜¯å¦ä¸ºæ•°å­—
- `string?` - æ˜¯å¦ä¸ºå­—ç¬¦ä¸²
- `eq?` - ç›¸ç­‰æ€§æµ‹è¯•
- `=`, `<`, `>`, `<=`, `>=` - æ•°å€¼æ¯”è¾ƒ

### 5. é€»è¾‘è¿ç®—
- `not` - é€»è¾‘é
- `and` - é€»è¾‘ä¸(çŸ­è·¯æ±‚å€¼)
- `or` - é€»è¾‘æˆ–(çŸ­è·¯æ±‚å€¼)

### 6. I/O æ“ä½œ
- `display` - è¾“å‡ºå€¼
- `newline` - è¾“å‡ºæ¢è¡Œ

### 7. å°¾é€’å½’ä¼˜åŒ– (TCO)
- ç›´æ¥ lambda å°¾é€’å½’ä¼˜åŒ–
- ä½¿ç”¨å¾ªç¯ä»£æ›¿é€’å½’è°ƒç”¨
- æ”¯æŒçº¦ 10,000 æ¬¡å°¾é€’å½’è°ƒç”¨ä¸æº¢å‡º
- åœ¨ `if`, `let`, `begin` ä¸­æ­£ç¡®è¯†åˆ«å°¾ä½ç½®

### 8. å®ç³»ç»Ÿ
- `define-syntax` - å®šä¹‰å«ç”Ÿå®
- `syntax-rules` - æ¨¡å¼åŒ¹é…å’Œæ¨¡æ¿å±•å¼€
- æ”¯æŒå­—é¢é‡å’Œæ¨¡å¼å˜é‡
- é€’å½’å®å±•å¼€

## ğŸ“ é¡¹ç›®ç»“æ„

```
mylisp-rs/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ ast.rs       # æŠ½è±¡è¯­æ³•æ ‘å®šä¹‰
â”‚   â”œâ”€â”€ env.rs       # ç¯å¢ƒå’Œä½œç”¨åŸŸç®¡ç†
â”‚   â”œâ”€â”€ eval.rs      # æ±‚å€¼å™¨æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ lexer.rs     # è¯æ³•åˆ†æå™¨
â”‚   â”œâ”€â”€ parser.rs    # è¯­æ³•åˆ†æå™¨
â”‚   â””â”€â”€ main.rs      # REPL å’Œæ–‡ä»¶æ‰§è¡Œ
â”œâ”€â”€ test_*.lisp      # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ *.md             # æ–‡æ¡£æ–‡ä»¶
â””â”€â”€ Cargo.toml       # Rust é¡¹ç›®é…ç½®
```

## ğŸ¯ æ ¸å¿ƒå®ç°äº®ç‚¹

### 1. å…ƒå¾ªç¯æ±‚å€¼
- `final_bootstrap.lisp` å±•ç¤ºå¦‚ä½•ç”¨ Lisp å®ç° Lisp
- æ”¯æŒè‡ªä¸¾(bootstrapping)æ¦‚å¿µ

### 2. è¯æ³•ä½œç”¨åŸŸ
- ç¯å¢ƒé“¾å®ç°ä½œç”¨åŸŸåµŒå¥—
- æ­£ç¡®çš„å˜é‡æ•è·

### 3. é—­åŒ…
- Lambda æ•è·å®šä¹‰æ—¶ç¯å¢ƒ
- æ”¯æŒé«˜é˜¶å‡½æ•°

### 4. å‡½æ•°å¼ç¼–ç¨‹
- ä¸å¯å˜æ•°æ®ç»“æ„
- çº¯å‡½æ•°å¼æ“ä½œ
- é«˜é˜¶å‡½æ•°æ”¯æŒ

## âš ï¸ å½“å‰é™åˆ¶

### TCO é™åˆ¶
- åªä¼˜åŒ–ç›´æ¥ lambda è°ƒç”¨
- é—´æ¥é€’å½’(é€šè¿‡ç¬¦å·æŸ¥æ‰¾)ä¸ä¼˜åŒ–
- ç¯å¢ƒé“¾æ¯æ¬¡ä»ä¼šå…‹éš†

### å®ç³»ç»Ÿé™åˆ¶
- ä¸æ”¯æŒ `...` çœç•¥å·æ¨¡å¼
- å›ºå®šå‚æ•°æ•°é‡åŒ¹é…
- å¯èƒ½å‘ç”Ÿå˜é‡æ•è·(éçœŸæ­£å«ç”Ÿå®)

### å…¶ä»–
- æ²¡æœ‰å®ç° continue/break
- set! åªèƒ½åœ¨å½“å‰ä½œç”¨åŸŸä¿®æ”¹
- ç¼ºå°‘å¼‚å¸¸å¤„ç†æœºåˆ¶

## ğŸ“š ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€è¿ç®—
```lisp
(+ 1 2 3)        ; â†’ 6
(* 4 5)          ; â†’ 20
(mod 10 3)       ; â†’ 1
```

### æ¡ä»¶è¡¨è¾¾å¼
```lisp
(cond
  ((> x 10) "large")
  ((= x 5) "five")
  (else "other"))
```

### é«˜é˜¶å‡½æ•°
```lisp
(map (lambda (x) (* x 2)) (list 1 2 3))
; â†’ (2 4 6)

(filter (lambda (x) (> x 2)) (list 1 2 3 4))
; â†’ (3 4)

(fold (lambda (acc x) (+ acc x)) 0 (list 1 2 3))
; â†’ 6
```

### å®å®šä¹‰
```lisp
(define-syntax when
  (syntax-rules ()
    ((when test body)
     (if test body nil))))
```

### å°¾é€’å½’
```lisp
(define (sum n acc)
  (if (= n 0)
      acc
      (sum (- n 1) (+ acc n))))

(sum 10000 0)  ; ä¸ä¼šæ ˆæº¢å‡º
```

## ğŸ§ª æµ‹è¯•

è¿è¡Œæµ‹è¯•:
```bash
# åŸºç¡€åŠŸèƒ½æµ‹è¯•
./target/release/mylisp test_all.lisp

# TCO æµ‹è¯•
./target/release/mylisp test_tco.lisp

# å®æµ‹è¯•
./target/release/mylisp test_macro_simple.lisp

# cond å’Œ begin æµ‹è¯•
./target/release/mylisp test_cond_begin.lisp

# é«˜é˜¶å‡½æ•°æµ‹è¯•
./target/release/mylisp test_higher_order.lisp
```

## ğŸ“– å‚è€ƒæ–‡æ¡£

- `CLAUDE.md` - é¡¹ç›®æ¦‚è¿°å’Œæ„å»ºè¯´æ˜
- `BOOTSTRAP.md` - è‡ªä¸¾æ¦‚å¿µè¯¦è§£
- `TCO.md` - å°¾é€’å½’ä¼˜åŒ–å®ç°
- `MACRO.md` - å®ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸš€ æœªæ¥æ”¹è¿›æ–¹å‘

1. **å®Œæ•´çš„ TCO**
   - æ”¯æŒé—´æ¥é€’å½’ä¼˜åŒ–
   - ç¯å¢ƒé“¾é‡ç”¨è€Œéå…‹éš†

2. **å®Œæ•´çš„å®ç³»ç»Ÿ**
   - å®ç° `...` çœç•¥å·
   - çœŸæ­£çš„å«ç”Ÿå®

3. **æ€§èƒ½ä¼˜åŒ–**
   - æŒä¹…åŒ–æ•°æ®ç»“æ„
   - ç¼–è¯‘æœŸä¼˜åŒ–

4. **æ›´å¤šç‰¹æ€§**
   - æ¨¡å—ç³»ç»Ÿ
   - å¼‚å¸¸å¤„ç†
   - å­—ç¬¦ä¸²æ“ä½œåº“

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®åŸºäºä»¥ä¸‹æ¦‚å¿µ:
- **SICP** (Structure and Interpretation of Computer Programs) ç¬¬ 4 ç« 
- **Scheme R5RS** è¯­æ³•è§„èŒƒ
- **Rust** ç±»å‹ç³»ç»Ÿå’Œæ‰€æœ‰æƒæ¨¡å‹

---

MyLisp - ä¸€ä¸ªæ•™è‚²æ€§è´¨çš„ Lisp è§£é‡Šå™¨,å±•ç¤ºäº†è¯­è¨€å®ç°çš„æ ¸å¿ƒæ¦‚å¿µã€‚
