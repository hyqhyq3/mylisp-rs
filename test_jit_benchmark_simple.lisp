;; 简化的 JIT vs 解释器性能基准测试

(display "=== JIT vs Interpreter Performance Benchmark ===")
(newline)
(newline)

;; 测试 1: 简单算术运算
(display "Test 1: Simple arithmetic (10,000 iterations)")
(newline)
(display "  Interpreter: ")
(display (use-jit (syscall 1)))
(define i1 0)
(while (< i1 10000)
  (+ 1 2 3)
  (set! i1 (+ i1 1)))
(display (use-jit (syscall 1)))
(newline)
(newline)

(display "  JIT: ")
(display (use-jit (syscall 1)))
(define i2 0)
(while (< i2 10000)
  (use-jit (+ 1 2 3))
  (set! i2 (+ i2 1)))
(display (use-jit (syscall 1)))
(newline)
(newline)

;; 测试 2: Lambda 调用
(display "Test 2: Lambda call (10,000 iterations)")
(newline)
(display "  Interpreter: ")
(display (use-jit (syscall 1)))
(define i3 0)
(while (< i3 10000)
  ((lambda (x) (* x x)) 5)
  (set! i3 (+ i3 1)))
(display (use-jit (syscall 1)))
(newline)
(newline)

(display "  JIT: ")
(display (use-jit (syscall 1)))
(define i4 0)
(while (< i4 10000)
  (use-jit ((lambda (x) (* x x)) 5))
  (set! i4 (+ i4 1)))
(display (use-jit (syscall 1)))
(newline)
(newline)

(display "=== Benchmark completed ===")
(newline)
